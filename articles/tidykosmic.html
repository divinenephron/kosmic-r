<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to tidykosmic • tidykosmic</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to tidykosmic">
<meta property="og:description" content="tidykosmic">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidykosmic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tidykosmic.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/divinenephron/tidykosmic/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tidykosmic_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to tidykosmic</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/divinenephron/tidykosmic/blob/master/vignettes/tidykosmic.Rmd"><code>vignettes/tidykosmic.Rmd</code></a></small>
      <div class="hidden name"><code>tidykosmic.Rmd</code></div>

    </div>

    
    
<div id="the-purpose-of-tidykosmic-reference-intervals" class="section level2">
<h2 class="hasAnchor">
<a href="#the-purpose-of-tidykosmic-reference-intervals" class="anchor"></a>The Purpose of tidykosmic: Reference Intervals</h2>
<p>Most medical laboratory results are interpreted by comparing them to a reference interval, which describe the results you would expect in a healthy population. Reference intervals are established by first identifying reference individuals who meet pre-specified criteria for being “healthy”, then performing the laboratory investigation of interest on them. The results from these individuals are called reference values. The reference values are summarised using reference limits, and the interval between two reference limits is the reference interval. Reference intervals are usually calculated so that they include the central 95% of reference values.</p>
<p>The above method of establishing reference intervals is the “direct” method. It is the gold-standard method recommended by the IFCC and CLSI, but it has two main limitation. A lot of resources are needed to recruit the healthy participants perform the investigations, and because of this most direct reference interval studies use a small sample size, which leads to wide confidence intervals around the reference limits.</p>
<p>The limitation of direct methods of establishing reference intervals mean that “indirect” methods that mine routine laboratory data can be preferable. These methods require fewer resources because the data needed for them is readily available, and they can make use of large amounts of data, leading to narrow confidence intervals around the reference limits. The main limitation of indirect methods is that routine laboratory data will be contaminated with pathological results, which will affect the reference intervals calculated. tidykosmic is a tool that reduce the effect of this contamination, which was originally created by <span class="citation">Zierk et al. (2020)</span>.</p>
</div>
<div id="how-does-tidykosmic-work" class="section level2">
<h2 class="hasAnchor">
<a href="#how-does-tidykosmic-work" class="anchor"></a>How does tidykosmic work?</h2>
<p>Kosmic estimates the distribution of physiological results (reference values) from routine laboratory data that is contaminated with pathological results. It relies on the observation that the pathological results usually fall on the edge of the distribution of physiological result, so there is a section in the middle that contains very few pathological results. Kosmic follows the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Because the distribution of most laboratory results are skewed, a Box-Cox tranform is used on the data to reduce it. The parameter <code>lambda</code> is chosen to do this.</p></li>
<li><p>Kosmic chooses a section in the middle of the data between two truncation limits, <code>t1</code> and <code>t2</code>.</p></li>
<li><p>It then finds the normal distribution that fits the results results in this section the closes. The normal distribution is described by a <code>mean</code> and <code>sd</code>.</p></li>
<li><p>Steps 2 and 3 and repeated using many values of <code>t1</code> and <code>t2</code> to find the widest possible section that still fits a normal distribution well.</p></li>
<li><p>The reference intervals is calculated using the best distribution.</p></li>
</ol>
</div>
<div id="data-haemoglobin" class="section level2">
<h2 class="hasAnchor">
<a href="#data-haemoglobin" class="anchor"></a>Data: Haemoglobin</h2>
<p>The <code>haemoglobin</code> dataset will be used to demonstrate Kosmic. It is also available using the American English spelling, <code>hemoglobin</code>. It is a simulated dataset containing random physiological test results which were chosen to have a true reference interval of 12.0–16.0 g/dL. These results have been contaminated with pathological results at the lower and upper end of the distribution. It is documented in <code><a href="../reference/haemoglobin.html">?haemoglobin</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">haemoglobin</span>
<span class="co">#&gt;   result  age sex</span>
<span class="co">#&gt; 1   13.4 13.8   m</span>
<span class="co">#&gt; 2   14.2  8.0   w</span>
<span class="co">#&gt; 3   13.1  0.4   m</span>
<span class="co">#&gt; 4   15.6  7.0   m</span>
<span class="co">#&gt; 5   14.3 17.6   w</span>
<span class="co">#&gt;  [ reached 'max' / getOption("max.print") -- omitted 9995 rows ]</span></code></pre></div>
</div>
<div id="how-to-estimate-reference-intervals-using-kosmic" class="section level2">
<h2 class="hasAnchor">
<a href="#how-to-estimate-reference-intervals-using-kosmic" class="anchor"></a>How to estimate reference intervals using Kosmic</h2>
<p>Use <code><a href="../reference/kosmic.html">kosmic()</a></code> to estimate the distribution of physiological results. It takes as arguments a numeric vector of investigation results and the number of decimal places to use. Use the same number of decimal places as are use when reporting results, for example, haemoglobin in usually reported to 1 decimal place when quantitated as g/dL. Kosmic takes longer when it has to calculate to more decimal places.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kosmic.html">kosmic</a></span><span class="op">(</span><span class="va">haemoglobin</span><span class="op">$</span><span class="va">result</span>, decimals <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span>
<span class="co">#&gt; Distribution of physiological results estimated using kosmic </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of data points: 10000 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Distribution estimates:</span>
<span class="co">#&gt;          estimate</span>
<span class="co">#&gt; lambda  0.2000000</span>
<span class="co">#&gt; mean    3.4693861</span>
<span class="co">#&gt; sd      0.1178128</span>
<span class="co">#&gt; t1     12.8000000</span>
<span class="co">#&gt; t2     14.9000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Settings:</span>
<span class="co">#&gt;          setting</span>
<span class="co">#&gt; decimals 1.0e+00</span>
<span class="co">#&gt; t1min    5.0e-02</span>
<span class="co">#&gt; t1max    3.0e-01</span>
<span class="co">#&gt; t2min    7.0e-01</span>
<span class="co">#&gt; t2max    9.5e-01</span>
<span class="co">#&gt; sd_guess 8.0e-01</span>
<span class="co">#&gt; abstol   1.0e-07</span></code></pre></div>
<p>tidykosmic’s results can be plotted using <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>. By default this displays a histogram of the original results, the estimated distribution of physiological results, and the reference interval. This graph of frequency can also be specified explicitly using the argument <code>type = "frequency"</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></code></pre></div>
<p><img src="tidykosmic_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>The same information can be shown using a cumulative histogram.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">k</span>, type<span class="op">=</span><span class="st">"cumulative"</span><span class="op">)</span></code></pre></div>
<p><img src="tidykosmic_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The 2.5th, 50th and 97.5th percentiles can be calculated from the estimated distribution using <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>, which will print them, or <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code>, which will return the reference interval as a vector.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span>
<span class="co">#&gt; An estimated distribution of physiological results</span>
<span class="co">#&gt; with the following quantiles:</span>
<span class="co">#&gt;     2.5%    50.0%    97.5% </span>
<span class="co">#&gt; 12.14464 13.94471 15.95217</span>
<span class="va">ri</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ri</span><span class="op">)</span>
<span class="co">#&gt; [1] "numeric"</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ri</span><span class="op">)</span>
<span class="co">#&gt;     2.5%    50.0%    97.5% </span>
<span class="co">#&gt; 12.14464 13.94471 15.95217</span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs">
<div id="ref-zierkReferenceIntervalEstimation2020">
<p>Zierk, Jakob, Farhad Arzideh, Lorenz A. Kapsner, Hans-Ulrich Prokosch, Markus Metzler, and Manfred Rauh. 2020. “Reference Interval Estimation from Mixed Distributions Using Truncation Points and the Kolmogorov-Smirnov Distance (Kosmic).” <em>Scientific Reports</em> 10 (1): 1704. <a href="https://doi.org/10.1038/s41598-020-58749-2">https://doi.org/10.1038/s41598-020-58749-2</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Devon Buchanan, Jakob Zierck, Farhad Arzideh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
